<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE sqlMap
PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN"
"http://ibatis.apache.org/dtd/sql-map-2.dtd">
<sqlMap namespace="Activity">

<select id="getActivities" parameterClass="java.lang.String" resultClass="activity">
SELECT
appId as appId, 
body as body, 
bodyId as bodyId, 
externalId as externalId, 
activity_id as id, 
updated as updated, 
postedTime as postedTime, 
priority as priority, 
streamFaviconUrl as streamFaviconUrl,
streamSourceUrl as streamSourceUrl, 
streamTitle as streamTitle, 
streamUrl as streamUrl, 
title as title, 
titleId as titleId, 
url as url, 
userId userId
FROM SHINDIG_ACTIVITIES
WHERE userId = #uesr#
</select>

<select id="getMediaItems" parameterClass="activity" resultClass="mediaItem">
SELECT
mimetype as mimeType,
type as type,
url as url,
thumbnailUrl as thumbnailUrl
FROM SHINDIG_ACTIVITY_MEDIA_ITEMS
WHERE activity_id = #id# and user_id = #userId#
</select>


<select id="getTemplateParams" parameterClass="activity" resultClass="activityTemplateParamDB">
SELECT
param_key as param_key,
param_value as param_value
FROM SHINDIG_ACTIVITY_TEMPLATE_PARAMS
WHERE activity_id = #id# and user_id = #userId#
</select>


<!-- Use Activity object (JavaBean) properties as parameters for insert; but not mediaItems and templateParams of the activity. Each of the
parameters in the #hash# symbols is a JavaBeans property. -->
<insert id="insertActivity" parameterClass="activity">
INSERT INTO
SHINDIG_ACTIVITIES 
(app_id, body, body_id, external_id, activity_id, updated, posted_time, priority, stream_favicon_url,
stream_source_url, stream_title, stream_url, title, title_id, url, user_id)

VALUES 
(#appId#, #body#, #bodyId#, #externalId#, #id#, #updated#, #postedTime#, #priority#, #streamFaviconUrl#,
#streamSourceUrl#, #streamTitle#, #streamUrl#, #title#, #titleId#, #url#, #userId#)
</insert>


<!-- Use ActivityMediaItems object (JavaBean) properties as parameters for insert. Each of the
parameters in the #hash# symbols is a JavaBeans property. -->
<insert id="insertActivityMediaItem" parameterClass="activityMediaItemDB">
INSERT INTO
SHINDIG_ACTIVITY_MEDIA_ITEMS
(mime_type, type, url, thumbnail_url, activitiy_id, user_id)

VALUES 
(#mimeType#, #type#, #url#, #thumbnailUrl#, #activityId#, #userId#)
</insert>

<!-- Use ActivityTemplateParamh object (JavaBean) properties as parameters for insert. Each of the
parameters in the #hash# symbols is a JavaBeans property. -->
<insert id="insertTemplateParam" parameterClass="activityTemplateParamDB">
INSERT INTO
SHINDIG_ACTIVITY_TEMPLATE_PARAMS
(param_key, param_value, activity_id, user_id)

VALUES 
(#param_key#, #param_value#, #activityId#, #userId#)
</insert>


<!-- Use Activity object (JavaBean) properties as parameters for delete. Each of the
parameters in the #hash# symbols is a JavaBeans property. -->
<delete id="deleteActivities" parameterClass="activity">
DELETE FROM 
SHINDIG_ACTIVITIES
WHERE activity_id = #id# and user_id = #userId#
</delete>


<!-- Use Activity object (JavaBean) properties as parameters for delete. Each of the
parameters in the #hash# symbols is a JavaBeans property. -->
<delete id="deleteActivityMediaParams" parameterClass="activity">
DELETE FROM 
SHINDIG_ACTIVITIES_MEDIA_ITEMS
WHERE activity_id = #id# and user_id = #userId#
</delete>


<!-- Use Activity object (JavaBean) properties as parameters for delete. Each of the
parameters in the #hash# symbols is a JavaBeans property. -->
<delete id="deleteActivityTemplateParams" parameterClass="activity">
DELETE FROM 
SHINDIG_ACTIVITIES_TEMPLATE_PARAMS
WHERE activity_id = #id# and user_id = #userId#
</delete>

</sqlMap>